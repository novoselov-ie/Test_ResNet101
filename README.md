# Тестирование модели ResNet101 

> Тестирование модели ResNet101 для предсказаний значений составляющих почвы (NPK) по данным спектроскопии видимого и ближнего инфракрасного диапазона .

---

# Предсказание состава почвы с помощью модели ResNet101

Этот репозиторий содержит код для обучения и использования модели ResNet101 для предсказания значений составляющих почвы (NPK) на основе данных спектроскопии видимого и ближнего инфракрасного диапазона.

![Output](https://github.com/novoselov-ie/Test_ResNet101/blob/main/img/Table.png)

## Использование

### Тестирование модели

1. Убедитесь, что у вас установлены все необходимые зависимости:

    ```bash
    pip install pandas numpy torch scikit-learn matplotlib
    ```

2. Загрузите веса обученной модели:

    ```python
    import torch

    # Загрузка архитектуры модели
    from model import ResNet101Regressor

    # Укажите размер входных и выходных данных
    input_size = (4200, 4)
    output_size = 3

    # Загрузка архитектуры модели
    model = ResNet101Regressor(input_size, output_size)

    # Загрузка весов обученной модели
    state_dict = torch.load('путь/к/сохраненным/весам/модели.pt')

    # Загрузка весов модели
    model.load_state_dict(state_dict)
    ```

3. Подготовьте ваши тестовые данные и предобработайте их по необходимости. 

4. Используйте загруженную модель для делания предсказаний на тестовых данных:

    ```python
    import torch

    # Предполагая, что X_test_tensor содержит ваши тестовые данные в формате torch.Tensor
    with torch.inference_mode():
        model.eval()
        y_pred_tensor = model(X_test_tensor)
    ```

5. Преобразуйте предсказанный тензор обратно в формат NumPy и выполните любую необходимую последующую обработку или анализ:

    ```python
    # Преобразование предсказанного тензора в массив NumPy
    y_pred_numpy = y_pred_tensor.cpu().numpy()

    # Выполнение последующей обработки или анализа по необходимости
    ```

6. Проведите сравнительный анализ метрик для оценки производительности модели. Для этого используйте метрику R2 (коэффициент детерминации), которая измеряет долю дисперсии зависимой переменной, объясненную моделью:

    ```python
    from sklearn.metrics import r2_score

    # Предполагая, что y_test_orig содержит истинные метки для тестовых данных
    r2 = r2_score(y_test_orig, y_pred_original_2)
    print(f"R² Score: {r2:.3f}")
    ```

7. Визуализируйте результаты и оцените производительность модели с помощью гистограмм для визуального сравнения данных.

## Метрики оценки производительности

Для оценки производительности модели используется метрика R2 (коэффициент детерминации), которая измеряет долю дисперсии зависимой переменной, объясненную моделью. Чем ближе значение R2 к 1, тем лучше модель объясняет изменение зависимой переменной.

![Output](https://github.com/novoselov-ie/Test_ResNet101/blob/main/img/NPK.png)

## Визуализация результатов

Гистограммы используются для визуального сравнения истинных и предсказанных значений составляющих почвы. Это позволяет оценить, насколько близки предсказания модели к истинным значениям и выявить возможные расхождения.

![Output](https://github.com/novoselov-ie/Test_ResNet101/blob/main/img/gist.png)

#### Требования:
- Python 3.x
- PyTorch
- pandas
- NumPy
- scikit-learn
- Matplotlib






